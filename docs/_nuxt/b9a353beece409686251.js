(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{150:function(t,e,n){var c=n(6);c(c.P,"Array",{fill:n(151)}),n(72)("fill")},151:function(t,e,n){"use strict";var c=n(27),h=n(97),l=n(17);t.exports=function(t){for(var e=c(this),n=l(e.length),o=arguments.length,r=h(o>1?arguments[1]:void 0,n),v=o>2?arguments[2]:void 0,m=void 0===v?n:h(v,n);m>r;)e[r++]=t;return e}},153:function(t,e,n){"use strict";n.r(e);n(98),n(99),n(18),n(150);function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}var o=function(){function t(e){c(this,t),this.context=e.context,this.frequency=e.frequency||t.DEFAULT_VALUES.frequency,this.volume=e.volume||t.DEFAULT_VALUES.volume,this.attack=e.attack||t.DEFAULT_VALUES.attack,this.release=e.release||t.DEFAULT_VALUES.release,this.isPlaying=!1}return l(t,[{key:"play",value:function(){var t=this,e=this.context.currentTime;this.gain=this.context.createGain(),this.gain.gain.setValueAtTime(0,e),this.gain.gain.linearRampToValueAtTime(this.volume,e+this.attack),this.gain.connect(this.context.destination),this.osc=this.context.createOscillator(),this.osc.frequency.value=this.frequency,this.osc.connect(this.gain),this.osc.start(e),this.gain.gain.linearRampToValueAtTime(0,e+this.attack+this.release),this.osc.addEventListener("ended",(function(){t.gain.disconnect(t.context)})),this.osc.stop(e+this.attack+this.release)}}]),t}();o.DEFAULT_VALUES={volume:.7,frequency:880,attack:.005,release:.1};var r=function(){function t(canvas){c(this,t),this.context=canvas.getContext("2d"),this.width=canvas.width,this.height=canvas.height,this.lit=!1,this.lightAt=null,this.duration=200}return l(t,[{key:"tick",value:function(t){if(this.lit){var e=1-(t-this.lightAt)/this.duration;this.clear(),this.context.fillStyle="rgba(255, 255, 255, ".concat(e,")"),this.context.beginPath(),this.context.arc(this.width/2,this.height/2,this.width/2,0,2*Math.PI),this.context.fill()}}},{key:"on",value:function(t){this.lightAt=t,this.lit=!0}},{key:"off",value:function(){this.lightAt=null,this.lit=!1,this.clear()}},{key:"clear",value:function(){this.context.clearRect(0,0,this.width,this.height)}}]),t}(),v=function(){function t(e){c(this,t),this.light=e,this.nextLightingTime=0}return l(t,[{key:"tick",value:function(t,e){e&&(this.nextLightingTime=e),this.nextLightingTime<=t&&t<=this.nextLightingTime+this.light.duration?this.light.lit||this.light.on(t):this.light.lit&&this.light.off(),this.light.tick(t)}}]),t}(),m=function(){function t(e){c(this,t),this.context=e.context,this._bpm=e.bpm,this.nextNoteTime=0,this.voice=new o({context:this.context})}return l(t,[{key:"enqueue",value:function(t){var e=this.nextNoteTime-this.context.currentTime;if(!(e>.025))return this.voice.play(this.nextNoteTime),this.nextNoteTime+=this.secondsPerBeat,t+1e3*e}},{key:"clickNow",value:function(){this.nextNoteTime=this.context.currentTime,new o({context:this.context,volume:0}).play(this.nextNoteTime)}},{key:"bpm",set:function(t){this.secondsPerBeat=60/t,this._bpm=t},get:function(){return this._bpm}}]),t}(),y=function(){function t(e,n){var h=this,l=n.store,o=n.value;c(this,t),this.el=e,this.value=o,this.store=l,e.querySelectorAll("[name=numkey]").forEach((function(t){t.addEventListener("touchstart",h.onClickNumkey.bind(h))}))}return l(t,[{key:"onClickNumkey",value:function(t){var i=window.parseInt(t.target.textContent,10);this.value=(10*this.value+i)%1e3,this.store.commit("updateDisplayBpm",this.value),this.store.commit("updateBpm",this.validValue)}},{key:"validValue",get:function(){return this.value>250?250:this.value<20?20:this.value}}]),t}(),f=function(){function t(e){var n=this;c(this,t),this.store=e;var h=new(window.AudioContext||window.webkitAudioContext);this.clickScheduler=new m({context:h,bpm:e.state.bpm}),e.subscribe((function(){n.clickScheduler.bpm=e.state.bpm}));var l=new r(document.querySelector("#light"));this.lightScheduler=new v(l);var o=new y(document.querySelector("#tenkey"),{store:e,value:e.state.displayBpm});e.subscribe((function(){o.value=e.state.displayBpm})),e.subscribe((function(){for(var s=e.state.displayBpm.toString();s.length<3;)s="0"+s;document.querySelector("[name=bpm]").value=s})),document.querySelector("#toggle").addEventListener("touchstart",this.toggle.bind(this))}return l(t,[{key:"toggle",value:function(){this.store.commit("toggle"),this.store.state.running&&(this.clickScheduler.clickNow(),window.requestAnimationFrame(this.tick.bind(this)))}},{key:"tick",value:function(t){var e=null;this.store.state.running&&(e=this.clickScheduler.enqueue(t)),this.lightScheduler.tick(t,e),window.requestAnimationFrame(this.tick.bind(this))}}]),t}(),k={mounted:function(){this.app=new f(this.$store)}},d=n(24),component=Object(d.a)(k,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui-box"},[n("link",{attrs:{rel:"stylesheet",href:"/application.css"}}),t._v(" "),n("div",{staticClass:"ui",attrs:{id:"tenkey"}},[n("div",{staticClass:"row",staticStyle:{height:"24%"}},[n("div",{staticClass:"lcd col-12"},[n("input",{attrs:{name:"bpm",type:"number",value:"120"}}),t._v(" "),n("canvas",{attrs:{id:"light",height:"36",width:"36"}})])]),t._v(" "),n("div",{staticClass:"row",staticStyle:{height:"19%"}},[n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"7"}},[t._v("7")]),t._v(" "),n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"8"}},[t._v("8")]),t._v(" "),n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"9"}},[t._v("9")])]),t._v(" "),n("div",{staticClass:"row",staticStyle:{height:"19%"}},[n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"4"}},[t._v("4")]),t._v(" "),n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"5"}},[t._v("5")]),t._v(" "),n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"6"}},[t._v("6")])]),t._v(" "),n("div",{staticClass:"row",staticStyle:{height:"19%"}},[n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"1"}},[t._v("1")]),t._v(" "),n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"2"}},[t._v("2")]),t._v(" "),n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"3"}},[t._v("3")])]),t._v(" "),n("div",{staticClass:"row",staticStyle:{height:"19%"}},[n("a",{staticClass:"col-4 tenkey-key",attrs:{href:"#",name:"numkey",value:"0"}},[t._v("0")]),t._v(" "),n("a",{staticClass:"col-4 tenkey-key"}),t._v(" "),n("a",{staticClass:"col-4 tenkey-key",attrs:{id:"toggle",href:"#"}},[t._v("â–¶")])])])])}],!1,null,null,null);e.default=component.exports}}]);